#!/bin/bash

#workdir=/root/work
#mkdir -p ${workdir}

fence_key=/etc/cluster/fence_xvm.key
fence_key_b64="
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
"

hostname | grep ctrl > /dev/null 2>&1
#hostname | grep '.' > /dev/null 2>&1
if [ x"$?" = x"0" ]; then
	logger -t post-script "### (fence) install fence key"
	mkdir -p $(dirname ${fence_key})
	echo ${fence_key_b64} | base64 -i -d - > ${fence_key}
	# yum install -y fence-virt
else
	logger -t post-script "### (fence) no need to install fence key"
fi
